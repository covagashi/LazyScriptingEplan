{
  "eplanScriptExamples": {
    "metadata": {
      "version": "1.0",
      "description": "Comprehensive collection of EPLAN script examples for automation",
      "lastUpdated": "2025-01-30",
      "baseTemplate": {
        "imports": [
          "using Eplan.EplApi.ApplicationFramework;",
          "using Eplan.EplApi.Scripting;"
        ],
        "structure": {
          "className": "Class",
          "methodAttribute": "[Start]",
          "methodSignature": "public void Function()"
        }
      }
    },
    "scriptAttributes": {
      "execution": {
        "Start": {
          "description": "Executes script immediately when run",
          "usage": "Quick testing and immediate execution"
        }
      },
      "loading": {
        "DeclareAction": {
          "description": "Creates a custom action available in EPLAN",
          "usage": "Adds script as executable action"
        },
        "DeclareEventHandler": {
          "description": "Handles specific EPLAN events",
          "usage": "Responds to EPLAN system events"
        },
        "DeclareMenu": {
          "description": "Adds menu entries",
          "usage": "Integrates script into EPLAN menus"
        },
        "DeclareRegister": {
          "description": "Executes when script is loaded",
          "usage": "Initialization tasks"
        },
        "DeclareUnregister": {
          "description": "Executes when script is unloaded",
          "usage": "Cleanup tasks"
        }
      }
    },
    "categories": {
      "basicExamples": {
        "name": "Basic Script Examples",
        "description": "Fundamental EPLAN scripting examples",
        "examples": [
          {
            "id": "startScript",
            "name": "Basic Start Script",
            "description": "Simple script with Start attribute for immediate execution",
            "attribute": "Start",
            "script": [
              "using Eplan.EplApi.Scripting;",
              "using System.Windows.Forms;",
              "",
              "namespace Namespace",
              "{",
              "  public class Class",
              "  {",
              "    [Start]",
              "    public void Function()",
              "    {",
              "      MessageBox.Show(\"Scripting is great!\"); // Comment",
              "      return;",
              "    }",
              "  }",
              "}"
            ]
          },
          {
            "id": "declareAction",
            "name": "Declare Custom Action",
            "description": "Creates a custom action that can be called from EPLAN",
            "attribute": "DeclareAction",
            "script": [
              "using System.Windows.Forms;",
              "using Eplan.EplApi.Scripting;",
              "",
              "public class _01_FirstSteps_02_DeclareAction",
              "{",
              "  [DeclareAction(\"ActionName\")]",
              "  public void Function()",
              "  {",
              "    MessageBox.Show(\"Scripting is great!\");",
              "  }",
              "}"
            ]
          },
          {
            "id": "declareEventHandler",
            "name": "Event Handler",
            "description": "Handles project close event",
            "attribute": "DeclareEventHandler",
            "event": "onActionStart.String.XPrjActionProjectClose",
            "script": [
              "using System.Windows.Forms;",
              "using Eplan.EplApi.Scripting;",
              "",
              "public class _01_FirstSteps_03_DeclareEventHandler",
              "{",
              "  [DeclareEventHandler(\"onActionStart.String.XPrjActionProjectClose\")]",
              "  public void Function()",
              "  {",
              "    MessageBox.Show(\"Scripting is great!\");",
              "  }",
              "}"
            ]
          },
          {
            "id": "registerUnregister",
            "name": "Register/Unregister Handlers",
            "description": "Scripts that run when loading/unloading",
            "attributes": [
              "DeclareRegister",
              "DeclareUnregister"
            ],
            "script": [
              "using System.Windows.Forms;",
              "using Eplan.EplApi.Scripting;",
              "",
              "public class _01_FirstSteps_04_DeclareRegisterUnregister",
              "{",
              "  [DeclareRegister]",
              "  public void Register()",
              "  {",
              "    MessageBox.Show(\"Script loaded.\");",
              "  }",
              "",
              "  [DeclareUnregister]",
              "  public void UnRegister()",
              "  {",
              "    MessageBox.Show(\"Script unloaded.\");",
              "  }",
              "}"
            ]
          }
        ]
      },
      "actionExecution": {
        "name": "Action Execution",
        "description": "Examples of running EPLAN actions from scripts",
        "examples": [
          {
            "id": "singleAction",
            "name": "Single Action Execution",
            "description": "Execute a single EPLAN action",
            "script": [
              "using Eplan.EplApi.ApplicationFramework;",
              "using Eplan.EplApi.Scripting;",
              "",
              "public class _02_RunActions_01_SingleAction",
              "{",
              "  [Start]",
              "  public void Function()",
              "  {",
              "    CommandLineInterpreter cli = new CommandLineInterpreter();",
              "    cli.Execute(\"reports\");",
              "  }",
              "}"
            ]
          },
          {
            "id": "multipleActions",
            "name": "Multiple Actions Execution",
            "description": "Execute multiple EPLAN actions in sequence",
            "script": [
              "using Eplan.EplApi.ApplicationFramework;",
              "using Eplan.EplApi.Scripting;",
              "",
              "public class _02_RunActions_02_MultipleActions",
              "{",
              "  [Start]",
              "  public void Function()",
              "  {",
              "    CommandLineInterpreter cli = new CommandLineInterpreter();",
              "",
              "    cli.Execute(\"XMsgActionStartVerification\");",
              "    cli.Execute(\"reports\");",
              "    cli.Execute(\"ActionName\");",
              "  }",
              "}"
            ]
          },
          {
            "id": "actionsWithParameters",
            "name": "Actions with Parameters",
            "description": "Execute actions with parameters using ActionCallingContext",
            "script": [
              "using Eplan.EplApi.ApplicationFramework;",
              "using Eplan.EplApi.Scripting;",
              "",
              "public class _02_RunActions_03_ActionsWithParameter",
              "{",
              "  [Start]",
              "  public void Function()",
              "  {",
              "    CommandLineInterpreter cli = new CommandLineInterpreter();",
              "    ActionCallingContext acc = new ActionCallingContext();",
              "",
              "    acc.AddParameter(\"Name\", \"XGedIaFormatText\");",
              "    acc.AddParameter(\"height\", \"20\");",
              "",
              "    cli.Execute(\"XGedStartInteractionAction\", acc);",
              "  }",
              "}"
            ]
          },
          {
            "id": "actionOverloading",
            "name": "Action Overloading",
            "description": "Override existing EPLAN actions with custom behavior",
            "script": [
              "using Eplan.EplApi.ApplicationFramework;",
              "using Eplan.EplApi.Scripting;",
              "using System.Windows.Forms;",
              "",
              "public class _02_RunActions_04_ActionOverloading",
              "{",
              "  [DeclareAction(\"XSDShowMatchingMasterDialogAction\", 50)]",
              "  public void Function()",
              "  {",
              "    MessageBox.Show(\"Warning!\");",
              "",
              "    ActionCallingContext acc = new ActionCallingContext();",
              "    Eplan.EplApi.ApplicationFramework.Action action =",
              "      new ActionManager().FindBaseActionFromFunctionAction(false);",
              "    action.Execute(acc);",
              "  }",
              "}"
            ]
          }
        ]
      }
    }
  }
}