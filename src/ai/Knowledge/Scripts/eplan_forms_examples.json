{
  "eplanFormsExamples": {
    "metadata": {
      "version": "1.0",
      "description": "EPLAN Windows Forms examples for custom user interfaces",
      "category": "User Interface Development"
    },
    "categories": {
      "basicForms": {
        "name": "Basic Form Templates",
        "description": "Simple form templates and structures",
        "examples": [
          {
            "id": "formTemplate",
            "name": "Basic Form Template",
            "description": "Empty form template with proper structure",
            "files": [
              {
                "name": "FormTemplate.cs",
                "content": [
                  "using System.Windows.Forms;",
                  "using Eplan.EplApi.Scripting;",
                  "",
                  "public class FormTemplate : Form",
                  "{",
                  "  public FormTemplate()",
                  "  {",
                  "    InitializeComponent();",
                  "  }",
                  "",
                  "  #region Code generated by the Windows Form Designer",
                  "  private System.ComponentModel.IContainer components = null;",
                  "",
                  "  protected override void Dispose(bool disposing)",
                  "  {",
                  "    if (disposing && (components != null))",
                  "    {",
                  "      components.Dispose();",
                  "    }",
                  "    base.Dispose(disposing);",
                  "  }",
                  "",
                  "  private void InitializeComponent()",
                  "  {",
                  "      this.SuspendLayout();",
                  "      // ",
                  "      // FormTemplate",
                  "      // ",
                  "      this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);",
                  "      this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;",
                  "      this.ClientSize = new System.Drawing.Size(284, 261);",
                  "      this.Name = \"FormTemplate\";",
                  "      this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;",
                  "      this.Text = \"Template\";",
                  "      this.ResumeLayout(false);",
                  "",
                  "  }",
                  "  #endregion",
                  "",
                  "  [Start]",
                  "  public void Function()",
                  "  {",
                  "    FormTemplate form = new FormTemplate();",
                  "    form.ShowDialog();",
                  "  }",
                  "}"
                ]
              }
            ]
          }
        ]
      },
      "advancedForms": {
        "name": "Advanced Form Examples",
        "description": "Complex forms with controls and EPLAN integration",
        "examples": [
          {
            "id": "formsExample",
            "name": "Forms with Controls Example",
            "description": "Form with checkboxes, buttons, and progress bar",
            "files": [
              {
                "name": "FormsExample.cs",
                "content": [
                  "using System.Windows.Forms;",
                  "using Eplan.EplApi.ApplicationFramework;",
                  "using Eplan.EplApi.Base;",
                  "using Eplan.EplApi.Scripting;",
                  "",
                  "public class _09_Forms_02_FormsExample : System.Windows.Forms.Form",
                  "{",
                  "  private Button ButtonCancel;",
                  "  private Button ButtonOk;",
                  "  private CheckBox CheckBoxProjectCheck;",
                  "  private CheckBox CheckBoxReport;",
                  "  private CheckBox CheckBoxCheckAll;",
                  "  private Label LabelProject;",
                  "  private ProgressBar ProgressBarFull;",
                  "",
                  "  public _09_Forms_02_FormsExample()",
                  "  {",
                  "    InitializeComponent();",
                  "  }",
                  "",
                  "  [Start]",
                  "  public void Function()",
                  "  {",
                  "    _09_Forms_02_FormsExample form = new _09_Forms_02_FormsExample();",
                  "    form.ShowDialog();",
                  "  }",
                  "",
                  "  private void ButtonCancel_Click(object sender, System.EventArgs e)",
                  "  {",
                  "    this.Close();",
                  "  }",
                  "",
                  "  private void ButtonOk_Click(object sender, System.EventArgs e)",
                  "  {",
                  "    CommandLineInterpreter cli = new CommandLineInterpreter();",
                  "",
                  "    ProgressBarFull.PerformStep();",
                  "    if (CheckBoxProjectCheck.Checked)",
                  "    {",
                  "      cli.Execute(\"XMsgActionStartVerification\");",
                  "    }",
                  "",
                  "    ProgressBarFull.PerformStep();",
                  "    if (CheckBoxReport.Checked)",
                  "    {",
                  "      cli.Execute(\"reports\");",
                  "    }",
                  "",
                  "    ProgressBarFull.PerformStep();   ",
                  "    ProgressBarFull.Value = 0;",
                  "",
                  "    this.Close();",
                  "  }",
                  "",
                  "  private void CheckBoxCheckAll_CheckedChanged(object sender, System.EventArgs e)",
                  "  {",
                  "    if (CheckBoxCheckAll.Checked)",
                  "    {",
                  "      CheckBoxProjectCheck.Checked = true;",
                  "      CheckBoxReport.Checked = true;",
                  "    }",
                  "    else",
                  "    {",
                  "      CheckBoxProjectCheck.Checked = false;",
                  "      CheckBoxReport.Checked = false;",
                  "    }",
                  "  }",
                  "",
                  "  private void FormsExample_Load(object sender, System.EventArgs e)",
                  "  {",
                  "    LabelProject.Text = PathMap.SubstitutePath(\"$(PROJECTNAME)\");",
                  "  }",
                  "",
                  "  // ... Designer code section would contain InitializeComponent() ...",
                  "}"
                ]
              }
            ]
          },
          {
            "id": "projectSearch",
            "name": "Project Search Form",
            "description": "Advanced form for searching and opening EPLAN projects",
            "files": [
              {
                "name": "ProjectSearch.cs",
                "content": [
                  "using System;",
                  "using System.IO;",
                  "using System.Windows.Forms;",
                  "using Eplan.EplApi.ApplicationFramework;",
                  "using Eplan.EplApi.Base;",
                  "using Eplan.EplApi.Scripting;",
                  "",
                  "public class _09_Forms_04_ProjectSearch : System.Windows.Forms.Form",
                  "{",
                  "  public string ProjectPath = string.Empty;",
                  "",
                  "  private System.Windows.Forms.Button ButtonOK;",
                  "  private System.Windows.Forms.ListView ListViewResult;",
                  "  private System.Windows.Forms.Button ButtonSearch;",
                  "  private System.Windows.Forms.TextBox TextBoxSearch;",
                  "  private System.Windows.Forms.StatusStrip StatusStipMain;",
                  "  private System.Windows.Forms.Button ButtonCancel;",
                  "  private ToolStripStatusLabel ToolStripLabel;",
                  "",
                  "  [DeclareAction(\"ProjectSearch\")]",
                  "  public void Function()",
                  "  {",
                  "    _09_Forms_04_ProjectSearch form = new _09_Forms_04_ProjectSearch();",
                  "    form.ShowDialog();",
                  "  }",
                  "",
                  "  private void _09_Forms_04_ProjectSearch_Load(object sender, System.EventArgs e)",
                  "  {",
                  "    ProjectPath = PathMap.SubstitutePath(\"$(MD_PROJECTS)\");",
                  "    TextBoxSearch.Select();",
                  "  }",
                  "",
                  "  private void OpenProject(string fullProjectPath)",
                  "  {",
                  "    Cursor.Current = Cursors.WaitCursor;",
                  "",
                  "    ToolStripLabel.Text = \"Opening project '\" + Path.GetFileNameWithoutExtension(fullProjectPath) + \"'...\";",
                  "",
                  "    this.Update();",
                  "",
                  "    CommandLineInterpreter cli = new CommandLineInterpreter();",
                  "    ActionCallingContext acc = new ActionCallingContext();",
                  "    acc.AddParameter(\"Project\", fullProjectPath);",
                  "    cli.Execute(\"ProjectOpen\", acc);",
                  "",
                  "    Cursor.Current = Cursors.Default;",
                  "  }",
                  "",
                  "  private void ButtonSearch_Click(object sender, System.EventArgs e)",
                  "  {",
                  "    Cursor.Current = Cursors.WaitCursor;",
                  "",
                  "    ToolStripLabel.Text = \"Searching project(s)...\";",
                  "",
                  "    ListViewResult.BeginUpdate();",
                  "",
                  "    GetProjects();",
                  "",
                  "    ListViewResult.AutoResizeColumns(ColumnHeaderAutoResizeStyle.ColumnContent);",
                  "",
                  "    ListViewResult.EndUpdate();",
                  "",
                  "    Cursor.Current = Cursors.Default;",
                  "  }",
                  "",
                  "  private void GetProjects()",
                  "  {",
                  "    ListViewResult.Items.Clear();",
                  "",
                  "    string[] result = Directory.GetFiles(ProjectPath,",
                  "      \"*\" + TextBoxSearch.Text + \"*.el*\",",
                  "      SearchOption.TopDirectoryOnly);",
                  "",
                  "    foreach (string project in result)",
                  "    {",
                  "      FillListView(project);",
                  "    }",
                  "",
                  "    ToolStripLabel.Text = \"Projects found: \" + ListViewResult.Items.Count.ToString();",
                  "  }",
                  "",
                  "  private void FillListView(string fullPath)",
                  "  {",
                  "    FileInfo fileInfo = new FileInfo(fullPath);",
                  "",
                  "    string fileNameWithoutExtension = Path.GetFileNameWithoutExtension(fileInfo.FullName);",
                  "    string directory = fileInfo.Directory.ToString() + @\"\\\";",
                  "    string extension = fileInfo.Extension;",
                  "",
                  "    ListViewItem listViewItem = new ListViewItem();",
                  "    listViewItem.Text = fileNameWithoutExtension;",
                  "    listViewItem.SubItems.Add(directory);",
                  "    listViewItem.SubItems.Add(extension);",
                  "    ListViewResult.Items.Add(listViewItem);",
                  "  }",
                  "",
                  "  // ... Additional event handlers and designer code ...",
                  "}"
                ]
              }
            ]
          }
        ]
      },
      "utilityExamples": {
        "name": "Utility Examples",
        "description": "Cursor and other UI utilities",
        "examples": [
          {
            "id": "cursorExample",
            "name": "Cursor Control",
            "description": "Changing cursor states during operations",
            "script": [
              "using Eplan.EplApi.Scripting;",
              "using System.Threading;",
              "using System.Windows.Forms;",
              "",
              "public class _09_Forms_03_Cursor",
              "{",
              "  [Start]",
              "  public void Function()",
              "  {",
              "    Cursor.Current = Cursors.AppStarting;",
              "    Thread.Sleep(3000);",
              "    Cursor.Current = Cursors.WaitCursor;",
              "    Thread.Sleep(3000);",
              "    Cursor.Current = Cursors.Default;",
              "  }",
              "}"
            ]
          }
        ]
      }
    },
    "formComponents": {
      "basicControls": [
        "Button - Standard buttons for actions",
        "Label - Text display",
        "TextBox - Text input",
        "CheckBox - Boolean selection",
        "ListView - Data display with columns",
        "ProgressBar - Progress indication"
      ],
      "layoutControls": [
        "StatusStrip - Bottom status bar",
        "ToolStripStatusLabel - Status bar labels"
      ]
    },
    "designPatterns": {
      "formStructure": {
        "inheritance": "Inherit from System.Windows.Forms.Form",
        "constructor": "Call InitializeComponent() in constructor",
        "disposal": "Override Dispose method for cleanup",
        "designerRegion": "Use #region for designer-generated code"
      },
      "eplanIntegration": {
        "pathVariables": "Use PathMap.SubstitutePath() for EPLAN paths",
        "actions": "Execute EPLAN actions via CommandLineInterpreter",
        "cursors": "Change cursor during long operations",
        "attributes": "Use [DeclareAction] to expose as EPLAN action"
      }
    },
    "bestPractices": {
      "performance": [
        "Use BeginUpdate/EndUpdate for ListView operations",
        "Show wait cursor during long operations",
        "Call Update() to refresh UI during operations"
      ],
      "userExperience": [
        "Center forms on screen",
        "Provide status feedback",
        "Enable/disable controls based on state",
        "Handle double-click events for quick actions"
      ]
    }
  }
}